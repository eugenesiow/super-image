
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="State-of-the-art image super resolution models for PyTorch.">
      
      
      
      
        <link rel="canonical" href="https://eugenesiow.github.io/super-image/models/awsrn/">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.1, mkdocs-material-6.2.8">
    
    
      
        <title>Lightweight Image Super-Resolution with Adaptive Weighted Learning Network (AWSRN) - super-image</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.cb6bc1d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.39b8e14a.min.css">
        
          
          
          <meta name="theme-color" content="#009485">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/mkdocstrings.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="purple">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lightweight-image-super-resolution-with-adaptive-weighted-learning-network-awsrn" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://eugenesiow.github.io/super-image/" title="super-image" class="md-header-nav__button md-logo" aria-label="super-image">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            super-image
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Lightweight Image Super-Resolution with Adaptive Weighted Learning Network (AWSRN)
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/eugenesiow/super-image/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eugenesiow/super-image
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        Home
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../edsr/" class="md-tabs__link">
        Models
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../reference/cli/" class="md-tabs__link">
        Reference
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../contributing/" class="md-tabs__link">
        Development
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://eugenesiow.github.io/super-image/" title="super-image" class="md-nav__button md-logo" aria-label="super-image">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    super-image
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/eugenesiow/super-image/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eugenesiow/super-image
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1" >
      
      <label class="md-nav__link" for="nav-1">
        Home
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Home" data-md-level="1">
        <label class="md-nav__title" for="nav-1">
          <span class="md-nav__icon md-icon"></span>
          Home
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1-2" type="checkbox" id="nav-1-2" >
      
      <label class="md-nav__link" for="nav-1-2">
        Tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Tutorials" data-md-level="2">
        <label class="md-nav__title" for="nav-1-2">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../prediction/" class="md-nav__link">
        Prediction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../training/" class="md-nav__link">
        Training
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/" class="md-nav__link">
        Evaluation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../license/" class="md-nav__link">
        License
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
      
      <label class="md-nav__link" for="nav-2">
        Models
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Models" data-md-level="1">
        <label class="md-nav__title" for="nav-2">
          <span class="md-nav__icon md-icon"></span>
          Models
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../edsr/" class="md-nav__link">
        EDSR
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../msrn/" class="md-nav__link">
        MSRN
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../a2n/" class="md-nav__link">
        A2N
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../pan/" class="md-nav__link">
        PAN
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../carn/" class="md-nav__link">
        CARN
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
      
      <label class="md-nav__link" for="nav-3">
        Reference
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="nav-3">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/" class="md-nav__link">
        CLI
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/configuration/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/models/" class="md-nav__link">
        Models
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/trainer/" class="md-nav__link">
        Trainer
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
      
      <label class="md-nav__link" for="nav-4">
        Development
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Development" data-md-level="1">
        <label class="md-nav__title" for="nav-4">
          <span class="md-nav__icon md-icon"></span>
          Development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../code_of_conduct/" class="md-nav__link">
        Code of Conduct
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../coverage/" class="md-nav__link">
        Coverage report
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#awsrnconfig" class="md-nav__link">
    AwsrnConfig
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#super_image.models.awsrn.configuration_awsrn.AwsrnConfig" class="md-nav__link">
    super_image.models.awsrn.configuration_awsrn.AwsrnConfig
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#super_image.models.awsrn.configuration_awsrn.AwsrnConfig.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#awsrnmodel" class="md-nav__link">
    AwsrnModel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#super_image.models.awsrn.modeling_awsrn.AwsrnModel" class="md-nav__link">
    super_image.models.awsrn.modeling_awsrn.AwsrnModel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#super_image.models.awsrn.modeling_awsrn.AwsrnModel.config_class" class="md-nav__link">
    config_class
  </a>
  
    <nav class="md-nav" aria-label="config_class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#super_image.models.awsrn.modeling_awsrn.AwsrnModel.config_class.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#super_image.models.awsrn.modeling_awsrn.AwsrnModel.forward" class="md-nav__link">
    forward()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#super_image.models.awsrn.modeling_awsrn.AwsrnModel.load_state_dict" class="md-nav__link">
    load_state_dict()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/eugenesiow/super-image/edit/master/docs/models/awsrn.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="lightweight-image-super-resolution-with-adaptive-weighted-learning-network-awsrn">Lightweight Image Super-Resolution with Adaptive Weighted Learning Network (AWSRN)<a class="headerlink" href="#lightweight-image-super-resolution-with-adaptive-weighted-learning-network-awsrn" title="Permanent link">#</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">#</a></h2>
<p>Deep learning has been successfully applied to the single-image super-resolution (SISR) task with great performance in recent years. However, most convolutional neural network based SR models require heavy computation, which limit their real-world applications. In this work, a lightweight SR network, named Adaptive Weighted Super-Resolution Network (AWSRN), is proposed for SISR to address this issue. A novel local fusion block (LFB) is designed in AWSRN for efficient residual learning, which consists of stacked adaptive weighted residual units (AWRU) and a local residual fusion unit (LRFU). Moreover, an adaptive weighted multi-scale (AWMS) module is proposed to make full use of features in reconstruction layer. AWMS consists of several different scale convolutions, and the redundancy scale branch can be removed according to the contribution of adaptive weights in AWMS for lightweight network. The experimental results on the commonly used datasets show that the proposed lightweight AWSRN achieves superior performance on ×2, ×3, ×4, and ×8 scale factors to state-of-the-art methods with similar parameters and computational overhead.The PAN model proposes a a lightweig1ht convolutional neural network for image super resolution. Pixel attention (PA) is similar to channel attention and spatial attention in formulation. PA however produces 3D attention maps instead of a 1D attention vector or a 2D map. This attention scheme introduces fewer additional parameters but generates better SR results.Deep learning has been successfully applied to the single-image super-resolution (SISR) task with great performance in recent years. However, most convolutional neural network based SR models require heavy computation, which limit their real-world applications. In this work, a lightweight SR network, named Adaptive Weighted Super-Resolution Network (AWSRN), is proposed for SISR to address this issue. A novel local fusion block (LFB) is designed in AWSRN for efficient residual learning, which consists of stacked adaptive weighted residual units (AWRU) and a local residual fusion unit (LRFU). Moreover, an adaptive weighted multi-scale (AWMS) module is proposed to make full use of features in reconstruction layer. AWMS consists of several different scale convolutions, and the redundancy scale branch can be removed according to the contribution of adaptive weights in AWMS for lightweight network. The experimental results on the commonly used datasets show that the proposed lightweight AWSRN achieves superior performance on ×2, ×3, ×4, and ×8 scale factors to state-of-the-art methods with similar parameters and computational overhead.</p>
<p>This model also applies the balanced attention (BAM) method invented by <a href="https://arxiv.org/abs/2104.07566">Wang et al. (2021)</a> to further improve the results.</p>
<p>It was introduced in the paper <a href="https://arxiv.org/abs/1904.02358">Lightweight Image Super-Resolution with Adaptive Weighted Learning Network</a> by Wang et al. (2019) and first released in <a href="https://github.com/ChaofWang/AWSRN">this repository</a>.   </p>
<h2 id="awsrnconfig">AwsrnConfig<a class="headerlink" href="#awsrnconfig" title="Permanent link">#</a></h2>


  <div class="doc doc-object doc-class">

<a id="super_image.models.awsrn.configuration_awsrn.AwsrnConfig"></a>
    <div class="doc doc-contents first">

      <p>This is the configuration class to store the configuration of a :class:<code>~super_image.AwsrnModel</code>.
It is used to instantiate the model according to the specified arguments, defining the model architecture.
Instantiating a configuration with the defaults will yield a similar
configuration to that of the <a href="https://huggingface.co/eugenesiow/carn">AWSRN</a> architecture.
Configuration objects inherit from :class:<code>~super_image.PretrainedConfig</code> and can be used to control the model
outputs. Read the documentation from :class:<code>~super_image.PretrainedConfig</code> for more information.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">super_image</span> <span class="kn">import</span> <span class="n">AwsrnModel</span><span class="p">,</span> <span class="n">AwsrnConfig</span>
<span class="c1"># Initializing a configuration</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">AwsrnConfig</span><span class="p">(</span>
    <span class="n">scale</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>                                <span class="c1"># train a model to upscale 4x</span>
<span class="p">)</span>
<span class="c1"># Initializing a model from the configuration</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">AwsrnModel</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="c1"># Accessing the model configuration</span>
<span class="n">configuration</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">config</span>
</code></pre></div>




  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h2 class="doc doc-heading" id="super_image.models.awsrn.configuration_awsrn.AwsrnConfig.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_resblocks</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">block_feats</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">n_colors</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_feats</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">res_scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_awru</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">bam</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rgb_mean</span><span class="o">=</span><span class="p">(</span><span class="mf">0.4488</span><span class="p">,</span> <span class="mf">0.4371</span><span class="p">,</span> <span class="mf">0.404</span><span class="p">),</span> <span class="n">data_parallel</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a class="headerlink" href="#super_image.models.awsrn.configuration_awsrn.AwsrnConfig.__init__" title="Permanent link">#</a></h2>

    <div class="doc doc-contents ">


<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>scale</code></td>
        <td><code>int</code></td>
        <td><p>Scale for the model to train an upscaler/super-res model.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>n_resblocks</code></td>
        <td><code>int</code></td>
        <td><p>Number of LFB blocks.</p></td>
        <td><code>4</code></td>
      </tr>
      <tr>
        <td><code>block_feats</code></td>
        <td><code>int</code></td>
        <td><p>Number of block features.</p></td>
        <td><code>128</code></td>
      </tr>
      <tr>
        <td><code>n_feats</code></td>
        <td><code>int</code></td>
        <td><p>Number of feature maps.</p></td>
        <td><code>32</code></td>
      </tr>
      <tr>
        <td><code>n_awru</code></td>
        <td><code>int</code></td>
        <td><p>Number of n_awru in one LFB.</p></td>
        <td><code>4</code></td>
      </tr>
      <tr>
        <td><code>n_colors</code></td>
        <td><code>int</code></td>
        <td><p>Number of color channels.</p></td>
        <td><code>3</code></td>
      </tr>
      <tr>
        <td><code>res_scale</code></td>
        <td><code>int</code></td>
        <td><p>The residual scaling.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>bam</code></td>
        <td><code>bool</code></td>
        <td><p>Train using balanced attention.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>rgb_mean</code></td>
        <td><code>tuple</code></td>
        <td><p>The RGB mean of the train dataset.
You can use <code>~super_image.utils.metrics.calculate_mean_std</code> to calculate it.</p></td>
        <td><code>(0.4488, 0.4371, 0.404)</code></td>
      </tr>
      <tr>
        <td><code>data_parallel</code></td>
        <td><code>bool</code></td>
        <td><p>Option to use multiple GPUs for training.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>super_image\models\awsrn\configuration_awsrn.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">n_resblocks</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">block_feats</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">n_colors</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_feats</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">res_scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_awru</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
             <span class="n">bam</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rgb_mean</span><span class="o">=</span><span class="n">DIV2K_RGB_MEAN</span><span class="p">,</span> <span class="n">data_parallel</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        scale (int): Scale for the model to train an upscaler/super-res model.</span>
<span class="sd">        n_resblocks (int): Number of LFB blocks.</span>
<span class="sd">        block_feats (int): Number of block features.</span>
<span class="sd">        n_feats (int): Number of feature maps.</span>
<span class="sd">        n_awru (int): Number of n_awru in one LFB.</span>
<span class="sd">        n_colors (int):</span>
<span class="sd">            Number of color channels.</span>
<span class="sd">        res_scale (int):</span>
<span class="sd">            The residual scaling.</span>
<span class="sd">        bam (bool): Train using balanced attention.</span>
<span class="sd">        rgb_mean (tuple):</span>
<span class="sd">            The RGB mean of the train dataset.</span>
<span class="sd">            You can use `~super_image.utils.metrics.calculate_mean_std` to calculate it.</span>
<span class="sd">        data_parallel (bool):</span>
<span class="sd">            Option to use multiple GPUs for training.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_resblocks</span> <span class="o">=</span> <span class="n">n_resblocks</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">block_feats</span> <span class="o">=</span> <span class="n">block_feats</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_colors</span> <span class="o">=</span> <span class="n">n_colors</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_feats</span> <span class="o">=</span> <span class="n">n_feats</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_awru</span> <span class="o">=</span> <span class="n">n_awru</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">res_scale</span> <span class="o">=</span> <span class="n">res_scale</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bam</span> <span class="o">=</span> <span class="n">bam</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rgb_mean</span> <span class="o">=</span> <span class="n">rgb_mean</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data_parallel</span> <span class="o">=</span> <span class="n">data_parallel</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>

<h2 id="awsrnmodel">AwsrnModel<a class="headerlink" href="#awsrnmodel" title="Permanent link">#</a></h2>


  <div class="doc doc-object doc-class">

<a id="super_image.models.awsrn.modeling_awsrn.AwsrnModel"></a>
    <div class="doc doc-contents first">





  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="super_image.models.awsrn.modeling_awsrn.AwsrnModel.config_class">
        <code>config_class</code>



<a class="headerlink" href="#super_image.models.awsrn.modeling_awsrn.AwsrnModel.config_class" title="Permanent link">#</a></h2>

    <div class="doc doc-contents ">

      <p>This is the configuration class to store the configuration of a :class:<code>~super_image.AwsrnModel</code>.
It is used to instantiate the model according to the specified arguments, defining the model architecture.
Instantiating a configuration with the defaults will yield a similar
configuration to that of the <a href="https://huggingface.co/eugenesiow/carn">AWSRN</a> architecture.
Configuration objects inherit from :class:<code>~super_image.PretrainedConfig</code> and can be used to control the model
outputs. Read the documentation from :class:<code>~super_image.PretrainedConfig</code> for more information.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">super_image</span> <span class="kn">import</span> <span class="n">AwsrnModel</span><span class="p">,</span> <span class="n">AwsrnConfig</span>
<span class="c1"># Initializing a configuration</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">AwsrnConfig</span><span class="p">(</span>
    <span class="n">scale</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>                                <span class="c1"># train a model to upscale 4x</span>
<span class="p">)</span>
<span class="c1"># Initializing a model from the configuration</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">AwsrnModel</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="c1"># Accessing the model configuration</span>
<span class="n">configuration</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">config</span>
</code></pre></div>




  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="super_image.models.awsrn.modeling_awsrn.AwsrnModel.config_class.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_resblocks</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">block_feats</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">n_colors</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_feats</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">res_scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_awru</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">bam</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rgb_mean</span><span class="o">=</span><span class="p">(</span><span class="mf">0.4488</span><span class="p">,</span> <span class="mf">0.4371</span><span class="p">,</span> <span class="mf">0.404</span><span class="p">),</span> <span class="n">data_parallel</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a class="headerlink" href="#super_image.models.awsrn.modeling_awsrn.AwsrnModel.config_class.__init__" title="Permanent link">#</a></h3>

    <div class="doc doc-contents ">


<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>scale</code></td>
        <td><code>int</code></td>
        <td><p>Scale for the model to train an upscaler/super-res model.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>n_resblocks</code></td>
        <td><code>int</code></td>
        <td><p>Number of LFB blocks.</p></td>
        <td><code>4</code></td>
      </tr>
      <tr>
        <td><code>block_feats</code></td>
        <td><code>int</code></td>
        <td><p>Number of block features.</p></td>
        <td><code>128</code></td>
      </tr>
      <tr>
        <td><code>n_feats</code></td>
        <td><code>int</code></td>
        <td><p>Number of feature maps.</p></td>
        <td><code>32</code></td>
      </tr>
      <tr>
        <td><code>n_awru</code></td>
        <td><code>int</code></td>
        <td><p>Number of n_awru in one LFB.</p></td>
        <td><code>4</code></td>
      </tr>
      <tr>
        <td><code>n_colors</code></td>
        <td><code>int</code></td>
        <td><p>Number of color channels.</p></td>
        <td><code>3</code></td>
      </tr>
      <tr>
        <td><code>res_scale</code></td>
        <td><code>int</code></td>
        <td><p>The residual scaling.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>bam</code></td>
        <td><code>bool</code></td>
        <td><p>Train using balanced attention.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>rgb_mean</code></td>
        <td><code>tuple</code></td>
        <td><p>The RGB mean of the train dataset.
You can use <code>~super_image.utils.metrics.calculate_mean_std</code> to calculate it.</p></td>
        <td><code>(0.4488, 0.4371, 0.404)</code></td>
      </tr>
      <tr>
        <td><code>data_parallel</code></td>
        <td><code>bool</code></td>
        <td><p>Option to use multiple GPUs for training.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>super_image\models\awsrn\modeling_awsrn.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">n_resblocks</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">block_feats</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">n_colors</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_feats</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">res_scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_awru</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
             <span class="n">bam</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rgb_mean</span><span class="o">=</span><span class="n">DIV2K_RGB_MEAN</span><span class="p">,</span> <span class="n">data_parallel</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        scale (int): Scale for the model to train an upscaler/super-res model.</span>
<span class="sd">        n_resblocks (int): Number of LFB blocks.</span>
<span class="sd">        block_feats (int): Number of block features.</span>
<span class="sd">        n_feats (int): Number of feature maps.</span>
<span class="sd">        n_awru (int): Number of n_awru in one LFB.</span>
<span class="sd">        n_colors (int):</span>
<span class="sd">            Number of color channels.</span>
<span class="sd">        res_scale (int):</span>
<span class="sd">            The residual scaling.</span>
<span class="sd">        bam (bool): Train using balanced attention.</span>
<span class="sd">        rgb_mean (tuple):</span>
<span class="sd">            The RGB mean of the train dataset.</span>
<span class="sd">            You can use `~super_image.utils.metrics.calculate_mean_std` to calculate it.</span>
<span class="sd">        data_parallel (bool):</span>
<span class="sd">            Option to use multiple GPUs for training.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_resblocks</span> <span class="o">=</span> <span class="n">n_resblocks</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">block_feats</span> <span class="o">=</span> <span class="n">block_feats</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_colors</span> <span class="o">=</span> <span class="n">n_colors</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_feats</span> <span class="o">=</span> <span class="n">n_feats</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_awru</span> <span class="o">=</span> <span class="n">n_awru</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">res_scale</span> <span class="o">=</span> <span class="n">res_scale</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bam</span> <span class="o">=</span> <span class="n">bam</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rgb_mean</span> <span class="o">=</span> <span class="n">rgb_mean</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data_parallel</span> <span class="o">=</span> <span class="n">data_parallel</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  <div class="doc doc-object doc-method">



<h2 class="doc doc-heading" id="super_image.models.awsrn.modeling_awsrn.AwsrnModel.forward">
<code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span></code>


<a class="headerlink" href="#super_image.models.awsrn.modeling_awsrn.AwsrnModel.forward" title="Permanent link">#</a></h2>

    <div class="doc doc-contents ">

      <p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<p>.. note::
    Although the recipe for forward pass needs to be defined within
    this function, one should call the :class:<code>Module</code> instance afterwards
    instead of this since the former takes care of running the
    registered hooks while the latter silently ignores them.</p>

        <details class="quote">
          <summary>Source code in <code>super_image\models\awsrn\modeling_awsrn.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">bam</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb_mean</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span> <span class="o">/</span> <span class="mf">127.5</span>
    <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bam</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attention</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">+=</span> <span class="n">s</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">bam</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="mf">127.5</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb_mean</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span>
    <span class="k">return</span> <span class="n">x</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h2 class="doc doc-heading" id="super_image.models.awsrn.modeling_awsrn.AwsrnModel.load_state_dict">
<code class="highlight language-python"><span class="n">load_state_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state_dict</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a class="headerlink" href="#super_image.models.awsrn.modeling_awsrn.AwsrnModel.load_state_dict" title="Permanent link">#</a></h2>

    <div class="doc doc-contents ">

      <p>Copies parameters and buffers from :attr:<code>state_dict</code> into
this module and its descendants. If :attr:<code>strict</code> is <code>True</code>, then
the keys of :attr:<code>state_dict</code> must exactly match the keys returned
by this module's :meth:<code>~torch.nn.Module.state_dict</code> function.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>state_dict</code></td>
        <td><code>dict</code></td>
        <td><p>a dict containing parameters and
persistent buffers.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>strict</code></td>
        <td><code>bool</code></td>
        <td><p>whether to strictly enforce that the keys
in :attr:<code>state_dict</code> match the keys returned by this module's
:meth:<code>~torch.nn.Module.state_dict</code> function. Default: <code>True</code></p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>``NamedTuple`` with ``missing_keys`` and ``unexpected_keys`` fields</code></td>
      <td><ul>
<li><strong>missing_keys</strong> is a list of str containing the missing keys<ul>
<li><strong>unexpected_keys</strong> is a list of str containing the unexpected keys</li>
</ul>
</li>
</ul></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>super_image\models\awsrn\modeling_awsrn.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">load_state_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state_dict</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">own_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">state_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">own_state</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">):</span>
                <span class="n">param</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">data</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">own_state</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">copy_</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;tail&#39;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">or</span>  <span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;skip&#39;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Replace pre-trained upsampler to new one...&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;While copying the parameter named </span><span class="si">{}</span><span class="s1">, &#39;</span>
                                       <span class="s1">&#39;whose dimensions in the model are </span><span class="si">{}</span><span class="s1"> and &#39;</span>
                                       <span class="s1">&#39;whose dimensions in the checkpoint are </span><span class="si">{}</span><span class="s1">.&#39;</span>
                                       <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">own_state</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">(),</span> <span class="n">param</span><span class="o">.</span><span class="n">size</span><span class="p">()))</span>
        <span class="k">elif</span> <span class="n">strict</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;tail&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;unexpected key &quot;</span><span class="si">{}</span><span class="s1">&quot; in state_dict&#39;</span>
                               <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">strict</span><span class="p">:</span>
        <span class="n">missing</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">own_state</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">state_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">missing</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;missing keys in state_dict: &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">missing</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.18f0862e.min.js"></script>
      <script src="../../assets/javascripts/bundle.994580cf.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: ['navigation.tabs'],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>